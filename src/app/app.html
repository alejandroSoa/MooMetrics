<ion-app>
  <!-- Auth Pages - Full Screen -->
  <div *ngIf="isAuthPage()" class="auth-layout">
    <router-outlet></router-outlet>
  </div>

  <!-- Main App Layout - With Sidebar -->
  <div *ngIf="!isAuthPage()" class="app-container">
    <!-- Persistent Sidebar -->
    <div class="persistent-sidebar">
      <!-- Logo -->
      <div class="logo">
        <div class="logo-icon">
          <span>MO</span>
          <span>ME</span>
        </div>
      </div>
      
      <!-- Admin Mode Toggle -->
      <div class="admin-toggle">
        <div class="admin-toggle-icon" (click)="toggleAdminMode()">
          <fa-icon [icon]="faUserShield"></fa-icon>
        </div>
        <div class="toggle-switch" (click)="toggleAdminMode()">
          <fa-icon [icon]="isAdminMode() ? faToggleOn : faToggleOff" 
                   [ngClass]="{'toggle-on': isAdminMode(), 'toggle-off': !isAdminMode()}"></fa-icon>
        </div>
      </div>
      
      <!-- Navigation Icons - Normal Mode -->
      <div class="nav-icons" *ngIf="!isAdminMode()">
        <div class="nav-icon-container">
          <div class="nav-active-indicator" *ngIf="isActive('/home')"></div>
          <a class="nav-icon" [routerLink]="['/home']">
            <fa-icon [icon]="faUsers"></fa-icon>
          </a>
        </div>

        <div class="nav-icon-container">
          <div class="nav-active-indicator" *ngIf="isActive('/notifications')"></div>
          <a class="nav-icon" [routerLink]="['/notifications']">
            <fa-icon [icon]="faBell"></fa-icon>
          </a>
        </div>
      </div>

      <!-- Navigation Icons - Admin Mode -->
      <div class="nav-icons" *ngIf="isAdminMode()">
        <div class="nav-icon-container">
          <div class="nav-active-indicator" *ngIf="isExactActive('/admin')"></div>
          <a class="nav-icon" [routerLink]="['/admin']">
            <fa-icon [icon]="faChartLine"></fa-icon>
          </a>
        </div>

        <div class="nav-icon-container">
          <div class="nav-active-indicator" *ngIf="isActive('/admin/users')"></div>
          <a class="nav-icon" [routerLink]="['/admin/users']">
            <fa-icon [icon]="faUsers"></fa-icon>
          </a>
        </div>

        <div class="nav-icon-container">
          <div class="nav-active-indicator" *ngIf="isActive('/admin/roles')"></div>
          <a class="nav-icon" [routerLink]="['/admin/roles']">
            <fa-icon [icon]="faUserTag"></fa-icon>
          </a>
        </div>

        <div class="nav-icon-container">
          <div class="nav-active-indicator" *ngIf="isActive('/admin/stables')"></div>
          <a class="nav-icon" [routerLink]="['/admin/stables']">
            <fa-icon [icon]="faWarehouse"></fa-icon>
          </a>
        </div>
      </div>

      <!-- Logout Icon -->
      <div class="logout-section">
        <div class="nav-icon-container">
          <a class="nav-icon logout-icon" (click)="showLogoutConfirmation()">
            <fa-icon [icon]="faArrowRightFromBracket"></fa-icon>
          </a>
        </div>
      </div>
    </div>

    <!-- Main Content Area -->
    <div class="main-content-area">
      <router-outlet></router-outlet>
    </div>

    <!-- Logout Confirmation Modal -->
    <div class="logout-modal-overlay" *ngIf="showLogoutConfirm()" (click)="cancelLogout()">
      <div class="logout-modal" (click)="$event.stopPropagation()">
        <div class="logout-modal-header">
          <h3>Cerrar Sesión</h3>
        </div>
        <div class="logout-modal-content">
          <p>¿Estás seguro de que quieres cerrar sesión?</p>
        </div>
        <div class="logout-modal-actions">
          <button class="logout-cancel-btn" (click)="cancelLogout()">Cancelar</button>
          <button class="logout-confirm-btn" (click)="confirmLogout()">Cerrar Sesión</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Install Prompt Component -->
  <app-install-prompt></app-install-prompt>
</ion-app>